<style>
.sub-heading {
    margin-bottom: 32px !important;
    width: max-content;
    padding: 8px 24px;
    display: flex;
    justify-content: center;
    align-items: center;
    gap: 8px;
    border-radius: 360px;
    border-width: 2px;
    border-style: dashed;
    border-color: #19191933;
    opacity: 1;
}
</style>

<section id="custom-tabs-{{ section.id }}" class="custom-tabs-section" data-section-id="{{ section.id }}">
  <div class="custom-tabs-inner" style="max-width:1440px; margin:0 auto; padding:80px 24px;">
    
    <div class="sub-heading" style="max-width:768px; margin:0 auto 40px; text-align:center;">{{section.settings.subheading}}</div>
    
    <!-- Heading + Paragraph -->
    <div class="heading-block" style="max-width:768px; margin:0 auto 40px; text-align:center;">
      <h2 style="font-size:32px; font-weight:700; margin:0;">{{ section.settings.heading }}</h2>
      <p style="margin-top:16px; color:#555; font-size:16px;">{{ section.settings.subtext }}</p>
    </div>

    <!-- Tabs -->
    <div class="tabs" style="display:flex; justify-content:center; gap:20px; margin-bottom:40px;">
      <button class="tab-button active" data-tab="tab1-{{ section.id }}" type="button"
              style="padding:12px 24px; border-radius:360px; border:1px solid #ccc; background:#000; color:#fff;">
        {{ section.settings.tab1_label }}
      </button>
      <button class="tab-button" data-tab="tab2-{{ section.id }}" type="button"
              style="padding:12px 24px; border-radius:360px; border:1px solid #ccc; background:#fff; color:#000;">
        {{ section.settings.tab2_label }}
      </button>
    </div>

    <!-- Tab Content 1 -->
    {% assign coll1 = collections[section.settings.collection_1] %}
    <div class="tab-content active" id="tab1-{{ section.id }}" aria-hidden="false">
      {% if coll1 and coll1.products_count > 0 %}
        <div class="products-grid" style="display:grid; grid-template-columns:repeat(auto-fit,minmax(280px,1fr)); gap:32px; width:1312px; max-width:100%; margin:0 auto;">
          {% for product in coll1.products limit:4 %}
            <article class="product-card" style="border:2px solid #eee; border-radius:24px; padding:24px; position:relative; text-align:left;">
              {% if product.featured_image %}
                <div class="product-image" style="width:256px; height:253px; margin:0 auto 16px;">
                  <img src="{{ product.featured_image | img_url: '480x480' }}" alt="{{ product.title | escape }}" style="width:100%; height:auto; border-radius:12px; display:block;">
                </div>
              {% endif %}
              <div class="badge" style="position:absolute; top:20px; left:20px; background:#FFD700; padding:8px 12px; border-radius:54px; border:1px solid #ccc; font-size:14px;">
                {{ section.settings.badge_text_1 | default: "Le plus populaire" }}
              </div>
              <div class="product-info" style="padding-left:0;">
                <h3 style="font-size:18px; font-weight:600; margin:0 0 8px;">{{ product.title }}</h3>
                <!-- optional price / link -->
              </div>
            </article>
          {% endfor %}
        </div>
      {% else %}
        <p style="text-align:center; color:#777;">Please select a collection for the first tab or add products to that collection.</p>
      {% endif %}
    </div>

    <!-- Tab Content 2 -->
    {% assign coll2 = collections[section.settings.collection_2] %}
    <div class="tab-content" id="tab2-{{ section.id }}" aria-hidden="true" style="display:none;">
      {% if coll2 and coll2.products_count > 0 %}
        <div class="products-grid" style="display:grid; grid-template-columns:repeat(auto-fit,minmax(280px,1fr)); gap:32px; width:1312px; max-width:100%; margin:0 auto;">
          {% for product in coll2.products limit:4 %}
            <article class="product-card" style="border:2px solid #eee; border-radius:24px; padding:24px; position:relative; text-align:left;">
              {% if product.featured_image %}
                <div class="product-image" style="width:256px; height:253px; margin:0 auto 16px;">
                  <img src="{{ product.featured_image | img_url: '480x480' }}" alt="{{ product.title | escape }}" style="width:100%; height:auto; border-radius:12px; display:block;">
                </div>
              {% endif %}
              <div class="badge" style="position:absolute; top:20px; left:20px; background:#fff; padding:8px 12px; border-radius:54px; border:1px solid #ccc; font-size:14px;">
                {{ section.settings.badge_text_2 | default: "Nouveau" }}
              </div>
              <div class="product-info" style="padding-left:0;">
                <h3 style="font-size:18px; font-weight:600; margin:0 0 8px;">{{ product.title }}</h3>
              </div>
            </article>
          {% endfor %}
        </div>
      {% else %}
        <p style="text-align:center; color:#777;">Please select a collection for the second tab or add products to that collection.</p>
      {% endif %}
    </div>
  </div>

  <style>
    /* minimal responsive tweaks (you can move to theme stylesheet) */
    @media (max-width: 768px) {
      #custom-tabs-{{ section.id }} .heading-block h2 { font-size:24px; }
      #custom-tabs-{{ section.id }} .product-image { width:100%; height:auto; }
    }
  </style>

  <script>
    (function() {
      var root = document.getElementById('custom-tabs-{{ section.id }}');
      if (!root) return;
      var buttons = root.querySelectorAll('.tab-button');
      buttons.forEach(function(button){
        button.addEventListener('click', function(){
          // deactivate all buttons in this section
          buttons.forEach(function(b){ b.classList.remove('active'); });
          button.classList.add('active');

          // hide all tab contents inside this section
          var contents = root.querySelectorAll('.tab-content');
          contents.forEach(function(c){
            c.style.display = 'none';
            c.setAttribute('aria-hidden','true');
          });

          var targetId = button.getAttribute('data-tab');
          var target = root.querySelector('#' + targetId);
          if (target) {
            target.style.display = '';
            target.setAttribute('aria-hidden','false');
          }
        });
      });
    })();
  </script>
</section>

{% schema %}
{
  "name": "Custom Tab Products",
  "settings": [
    {
      "type": "text",
      "id": "subheading",
      "label": "Sub Heading",
      "default": "Découvrir la gamme"
    },
    {
      "type": "text",
      "id": "heading",
      "label": "Section Heading",
      "default": "Stickers personnalisés"
    },
    {
      "type": "textarea",
      "id": "subtext",
      "label": "Section Paragraph",
      "default": "Créez des stickers uniques avec vos propres designs, parfaits pour personnaliser vos objets ou supports."
    },
    {
      "type": "collection",
      "id": "collection_1",
      "label": "First Tab Collection"
    },
    {
      "type": "collection",
      "id": "collection_2",
      "label": "Second Tab Collection"
    },
    {
      "type": "text",
      "id": "tab1_label",
      "label": "First Tab Label",
      "default": "Stickers"
    },
    {
      "type": "text",
      "id": "tab2_label",
      "label": "Second Tab Label",
      "default": "Étiquettes"
    },
    {
      "type": "text",
      "id": "badge_text_1",
      "label": "Badge text for tab1",
      "default": "Le plus populaire"
    },
    {
      "type": "text",
      "id": "badge_text_2",
      "label": "Badge text for tab2",
      "default": "Nouveau"
    }
  ],
  "presets": [
    {
      "name": "Custom Tab Products",
      "category": "Products"
    }
  ]
}
{% endschema %}
