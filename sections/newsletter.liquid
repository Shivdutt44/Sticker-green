{{ 'component-newsletter.css' | asset_url | stylesheet_tag }}
{{ 'newsletter-section.css' | asset_url | stylesheet_tag }}

{%- style -%}
/* ✅ Section Padding */
.section-{{ section.id }}-padding {
  padding-top: {{ section.settings.padding_top | times: 0.75 | round: 0 }}px;
  padding-bottom: {{ section.settings.padding_bottom | times: 0.75 | round: 0 }}px;
}
@media screen and (min-width: 750px) {
  .section-{{ section.id }}-padding {
    padding-top: {{ section.settings.padding_top }}px;
    padding-bottom: {{ section.settings.padding_bottom }}px;
  }
}

/* ✅ Newsletter Container */
.newsletter-container {
  background-color: #F5D274;
  padding: 5rem 0.5rem;
}

/* ✅ Wrapper */
.newsletter__wrapper {
  border: 2px dashed #19191980;
  border-radius: 40px;
  /* padding: 24px; */
  display: flex;
  flex-direction: column;
  gap: 45px;
  max-width: 1275px;
  margin: 0 auto;
}
.newsletter-form {
  max-width: 100% !important;
}

/* Desktop Layout */
@media screen and (min-width: 992px) {
  .newsletter__wrapper {
    flex-direction: row;
    justify-content: space-between;
    align-items: center;
     padding-inline: 5rem;
  }
}

/* ✅ Left Side */
.newsletter-content {
  flex: 1;
  text-align: center;
}
@media screen and (min-width: 992px) {
  .newsletter-content {
    text-align: left;
    max-width: 50%;
  }
}
.newsletter-content h1,
.newsletter-content h2 {
  color: #000;
  margin-bottom: 10px;
  line-height: 1.3;
}
.newsletter__subheading {
  color: #333;
}

/* ✅ Right Side (Form) */
.newsletter-form-container {
  flex: 1;
  display: flex;
  flex-direction: column;
  align-items: center;
}
@media screen and (min-width: 992px) {
  .newsletter-form-container {
    align-items: flex-start;
  }
}

/* ✅ Form Layout */
.newsletter-form__field-wrapper {
  display: flex;
  flex-direction: column;
  gap: 10px;
  width: 100%;
}
@media screen and (min-width: 576px) {
  .newsletter-form__field-wrapper {
    flex-direction: row;
    align-items: center;
    justify-content: flex-start;
    gap: 12px;
  }
}

/* ✅ Input Field */
.field__input {
  flex: 1;
  min-width: 220px;
  border: 1px solid #ccc;
  border-radius: 50px;
  padding: 14px 20px;
  outline: none;
  transition: border-color 0.3s ease;
}
.field__input:focus {
  border-color: #000;
}
.field__input::placeholder {
  color: #000; 
  opacity: 1; 
  font-size: 16px;
}
.newsletter-form__field-wrapper .field__input {
  color: black;
}
.newsletter-form__field-wrapper .field__input::placeholder {
  color: black;
}
.newsletter-form__field-wrapper .field__input:focus,
.newsletter-form__field-wrapper .field__input:hover {
  border: none;
}

/* ✅ Custom Newsletter Button */
.custom-newsletter-button {
  font-weight: 600;
  border: none;
  border-radius: 50px;
  padding: 14px 28px;
  cursor: pointer;
  transition: all 0.3s ease;
  background-color: {{ section.settings.button_background_color }};
  color: {{ section.settings.button_text_color }};
}
.custom-newsletter-button:hover {
  opacity: 0.9;
}

/* ✅ Privacy Policy Text */
.privacy-policy {
  color: #555;
  margin-top: 8px;
  text-align: center;
}
@media screen and (min-width: 576px) {
  .privacy-policy {
    text-align: left;
  }
}
.privacy-policy a {
  color: #000;
  text-decoration: underline;
}
.privacy-policy a:hover {
  text-decoration: none;
}
{%- endstyle -%}

<div class="newsletter-container">
  <div class="newsletter center {% if section.settings.full_width == false %}newsletter--narrow page-width{% endif %}">
    <div class="newsletter__wrapper section-{{ section.id }}-padding">
      
      <!-- Left Side: Heading & Text -->
      <div class="newsletter-content">
        {%- for block in section.blocks -%}
          {%- case block.type -%}
            {%- when 'heading' -%}
              <h2 class="{{ block.settings.heading_size }}">{{ block.settings.heading | escape }}</h2>
            {%- when 'paragraph' -%}
              <div class="newsletter__subheading rte">{{ block.settings.text }}</div>
          {%- endcase -%}
        {%- endfor -%}
      </div>
      
      <!-- Right Side: Form -->
      <div class="newsletter-form-container">
        {%- for block in section.blocks -%}
          {%- case block.type -%}
            {%- when 'email_form' -%}
              <div>
                {% form 'customer', class: 'newsletter-form' %}
                  <input type="hidden" name="contact[tags]" value="newsletter">
                  <div class="newsletter-form__field-wrapper">
                    <input
                      id="NewsletterForm--{{ section.id }}"
                      type="email"
                      name="contact[email]"
                      class="field__input"
                      value="{{ form.email }}"
                      placeholder="Email"
                      required
                    >
                    <button type="submit" class="custom-newsletter-button" name="commit" id="Subscribe">
                      S'abonner
                    </button>
                  </div>
                  <p class="privacy-policy">By subscribing you agree to our <a href="/policies/privacy-policy">Privacy Policy</a></p>
                {% endform %}
              </div>
          {%- endcase -%}
        {%- endfor -%}
      </div>
    </div>
  </div>
</div>

{% schema %}
{
  "name": "Newsletter",
  "tag": "section",
  "class": "section",
  "settings": [
    {
      "type": "select",
      "id": "color_scheme",
      "options": [
        { "value": "accent-1", "label": "Accent 1" },
        { "value": "accent-2", "label": "Accent 2" },
        { "value": "background-1", "label": "Background 1" },
        { "value": "background-2", "label": "Background 2" },
        { "value": "inverse", "label": "Inverse" }
      ],
      "default": "background-1",
      "label": "Color scheme"
    },
    {
      "type": "checkbox",
      "id": "full_width",
      "default": true,
      "label": "Full width"
    },
    {
      "type": "color",
      "id": "button_background_color",
      "label": "Button background color",
      "default": "#000000"
    },
    {
      "type": "color",
      "id": "button_text_color",
      "label": "Button text color",
      "default": "#ffffff"
    },
    {
      "type": "header",
      "content": "Padding"
    },
    {
      "type": "range",
      "id": "padding_top",
      "min": 0,
      "max": 100,
      "step": 4,
      "unit": "px",
      "label": "Top padding",
      "default": 40
    },
    {
      "type": "range",
      "id": "padding_bottom",
      "min": 0,
      "max": 100,
      "step": 4,
      "unit": "px",
      "label": "Bottom padding",
      "default": 52
    }
  ],
  "blocks": [
    {
      "type": "heading",
      "name": "Heading",
      "limit": 1,
      "settings": [
        {
          "type": "text",
          "id": "heading",
          "default": "Participer à l'aventure StickerGreen",
          "label": "Heading text"
        },
        {
          "type": "select",
          "id": "heading_size",
          "options": [
            { "value": "h2", "label": "H2" },
            { "value": "h1", "label": "H1" },
            { "value": "h0", "label": "H0" }
          ],
          "default": "h1",
          "label": "Heading size"
        }
      ]
    },
    {
      "type": "paragraph",
      "name": "Paragraph",
      "limit": 1,
      "settings": [
        {
          "type": "richtext",
          "id": "text",
          "default": "<p>Rejoignez notre newsletter pour participer à la transition vers la neutralité carbone.</p>",
          "label": "Paragraph text"
        }
      ]
    },
    {
      "type": "email_form",
      "name": "Email Form",
      "limit": 1
    }
  ],
  "presets": [
    {
      "name": "Newsletter",
      "blocks": [
        { "type": "heading" },
        { "type": "paragraph" },
        { "type": "email_form" }
      ]
    }
  ]
}
{% endschema %}
